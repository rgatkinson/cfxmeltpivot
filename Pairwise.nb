Notebook[{

Cell[CellGroupData[{
Cell["Pairwise: Data Analysis", \
"Title",ExpressionUUID->"39796d72-87ca-4320-97ff-a98d4bd016ce"],

Cell["\<\
Robert Atkinson
09 March 2020\
\>", "Author",ExpressionUUID->"05aea015-05f3-4e99-899d-20a8cd5792a1"],

Cell["We analyze data from various experiments", \
"Text",ExpressionUUID->"56cc4ba9-b77c-4512-b3b4-73f00a3c0eee"],

Cell[CellGroupData[{

Cell["Basics", \
"Section",ExpressionUUID->"752773aa-79a8-4543-97a4-9a28a9955492"],

Cell["Some utilities we\[CloseCurlyQuote]ll need", \
"Text",ExpressionUUID->"b3145be0-8eaf-4177-bf05-9735776e362f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"{", 
     RowBox[{"FrontEndToken", "[", 
      RowBox[{
       RowBox[{"InputNotebook", "[", "]"}], ",", "\"\<SelectAll\>\""}], "]"}],
      "}"}], "]"}], ";", "\n", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"{", 
     RowBox[{"FrontEndToken", "[", 
      RowBox[{
       RowBox[{"InputNotebook", "[", "]"}], ",", 
       "\"\<SelectionOpenAllGroups\>\""}], "]"}], "}"}], "]"}], ";"}], 
  "*)"}]], "Input",ExpressionUUID->"4308b520-54ec-4531-b566-b60a693897e8"],

Cell[BoxData[{
 RowBox[{"On", "[", "Assert", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "assert", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assert", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"assert", "[", 
   RowBox[{"expr", ",", " ", "\"\<assertion failed\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assert", "[", 
   RowBox[{"expr_", ",", " ", "msg_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"value", "=", 
      RowBox[{"Evaluate", "[", "expr", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"BooleanQ", "[", "value", "]"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{"value", ",", " ", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"msg", ",", " ", "\"\<: \>\"", ",", " ", 
           RowBox[{"HoldForm", "[", "expr", "]"}]}], "}"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{"value", ",", " ", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"msg", ",", " ", "\"\<: \>\"", ",", " ", 
           RowBox[{"HoldForm", "[", "expr", "]"}]}], "}"}], "]"}]}], "]"}]}], 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"to", " ", 
       RowBox[{"do", ":", " ", 
        RowBox[{"improve", " ", "message"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"assert", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"assert", "[", "False", "]"}], "\[IndentingNewLine]", 
 RowBox[{"assert", "[", "3", 
  "]"}]}], "Input",ExpressionUUID->"5325dfb4-04b1-494c-bcbd-e2677b467f94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"printCell", "[", "cell_", "]"}], " ", ":=", " ", 
  RowBox[{"CellPrint", "[", 
   RowBox[{"ExpressionCell", "[", 
    RowBox[{"cell", ",", " ", "\"\<Output\>\""}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPrint", "[", "cell_", "]"}], " ", ":=", " ", 
  RowBox[{"CellPrint", "[", 
   RowBox[{"ExpressionCell", "[", 
    RowBox[{"cell", ",", " ", "\"\<Output\>\""}], "]"}], 
   "]"}]}]}], "Input",ExpressionUUID->"37bb6aae-3724-4681-b762-434c36589e57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"log", "[", "msg_", "]"}], " ", ":=", " ", 
  RowBox[{"CellPrint", "[", 
   RowBox[{"TextCell", "[", 
    RowBox[{"msg", ",", " ", "\"\<Text\>\""}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"e7981d16-a332-4bc6-abdf-3a48fc8b52ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "evald", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"evald", " ", "=", " ", 
      RowBox[{"Evaluate", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"printCell", "[", 
      RowBox[{
       RowBox[{"HoldForm", "[", "expr", "]"}], " ", "\[Rule]", " ", "evald"}],
       "]"}], ";", "\[IndentingNewLine]", "evald"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test2", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "evald", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"printCell", "[", 
      RowBox[{
       RowBox[{"HoldForm", "[", "expr", "]"}], " ", "\[Rule]", " ", 
       "\"\<evaluating...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"evald", " ", "=", " ", 
      RowBox[{"Evaluate", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"printCell", "[", 
      RowBox[{"\"\<...\>\"", " ", "\[Rule]", " ", "evald"}], "]"}], ";", 
     "\[IndentingNewLine]", "evald"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"test", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"test2", ",", " ", "HoldAll"}], 
  "]"}]}], "Input",ExpressionUUID->"5aa89327-f38a-4c75-8bc4-5f11f8896fc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"complement", "[", "angle_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", 
   "angle"}]}]], \
"Input",ExpressionUUID->"78d80425-9321-49ab-b281-593a15d6063e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "hasImaginary", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hasImaginary", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Reap", "[", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"ee", ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ee", " ", "\[NotEqual]", " ", 
               RowBox[{"Conjugate", "[", "ee", "]"}]}], ",", " ", 
              RowBox[{"Sow", "[", "True", "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", "expr", "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "Infinity"}], "}"}]}], "]"}], 
        "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"ee", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ee", " ", "\[NotEqual]", " ", 
             RowBox[{"Conjugate", "[", "ee", "]"}]}], ",", " ", 
            RowBox[{"Return", "[", "True", "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", "expr", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Length", " ", "@", " ", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", ">", " ", "0"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "===", " ", "True"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"hasImaginary", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"hasImaginary", "[", 
    RowBox[{"1", " ", "+", " ", 
     RowBox[{"2", "I"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"hasImaginary", "[", 
    RowBox[{"30", "!"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"440d00c8-54b5-4b08-bfe8-ae5feb69d532"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"toDeg", "[", "rad_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rad", " ", "/", " ", "Pi"}], " ", "*", " ", 
   "180"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toRadian", "[", "deg_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"deg", " ", "/", " ", "180"}], " ", "*", " ", 
   "Pi"}]}]}], "Input",ExpressionUUID->"2bbc42e7-5161-4850-a96b-3fb814745a8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"variables", ",", " ", "unboundQ"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unboundQ", "[", "x_Symbol", "]"}], " ", ":=", " ", "True"}], "\n", 
 RowBox[{
  RowBox[{"unboundQ", "[", "_", "]"}], " ", ":=", " ", "False"}], "\n", 
 RowBox[{
  RowBox[{"unboundQ", "[", "E", "]"}], " ", ":=", " ", "False"}], "\n", 
 RowBox[{
  RowBox[{"unboundQ", "[", "I", "]"}], " ", ":=", " ", "False"}], "\n", 
 RowBox[{
  RowBox[{"unboundQ", "[", "Pi", "]"}], " ", ":=", " ", "False"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"unboundQ", "[", "\[Pi]", "]"}], " ", ":=", " ", "False"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"variables", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"variables", "[", 
   RowBox[{"expr", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"variables", "[", 
     RowBox[{"expr_", ",", " ", "except_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"result", ",", " ", "reaped"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"result", ",", " ", "reaped"}], "}"}], " ", "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"Scan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"unboundQ", "[", "#", "]"}], ",", 
               RowBox[{"Sow", "[", "#", "]"}]}], "]"}], ")"}], "&"}], ",", 
           "expr", ",", "Infinity"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "reaped", "]"}], " ", "==", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"reaped", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "Union"}], ",", "except"}],
           "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"variables", "[", 
    RowBox[{"e", " ", "\[Equal]", " ", 
     RowBox[{"m", " ", 
      RowBox[{"c", "^", "2"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"variables", "[", 
    RowBox[{"{", 
     RowBox[{"C", "[", "1", "]"}], "}"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"8fd2fa68-86de-4381-bd21-52f2d089b894"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "genericize", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genericize", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"genericize", "[", 
   RowBox[{"expr", ",", " ", "NumberQ", ",", " ", 
    RowBox[{"{", "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genericize", "[", 
   RowBox[{"expr_", ",", " ", "test_"}], "]"}], " ", ":=", " ", 
  RowBox[{"genericize", "[", 
   RowBox[{"expr", ",", " ", "test", ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"genericize", "[", 
     RowBox[{"expr_", ",", " ", "test_", ",", " ", "except_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", " ", "reaped", ",", " ", "numbers", ",", " ", "count", 
        ",", " ", "neg", ",", " ", "pos", ",", " ", "zero", ",", " ", 
        "constants", ",", " ", "constraints", ",", " ", "rules"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"result", ",", " ", "reaped"}], "}"}], " ", "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"Scan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"test", "[", "#", "]"}], ",", 
               RowBox[{"Sow", "[", "#", "]"}]}], "]"}], ")"}], "&"}], ",", 
           "expr", ",", "Infinity"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "reaped", "]"}], " ", ">", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"numbers", " ", "=", " ", 
           RowBox[{
            RowBox[{"reaped", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "Union"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"todo", ":", " ", 
            RowBox[{
             RowBox[{
             "should", " ", "we", " ", "merge", " ", "duplicates", " ", 
              "like", " ", 
              RowBox[{"this", "?", " ", "It"}], " ", "does", " ", "make", " ",
               "the", " ", "logic", " ", "below", " ", "somewhat", " ", 
              "easier"}], " ", "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"numbers", " ", "=", " ", 
           RowBox[{"Complement", "[", 
            RowBox[{"numbers", ",", "except"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numbers", " ", "=", " ", 
           RowBox[{"Sort", "[", "numbers", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"count", " ", "=", " ", 
           RowBox[{"Length", "[", "numbers", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"constants", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "#", "]"}], "&"}], " ", "/@", " ", 
            RowBox[{"Range", "[", "count", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"count", " ", ">", " ", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"constraints", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"constants", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "<", " ", 
                RowBox[{"constants", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "&"}], " ", "/@", 
              " ", 
              RowBox[{"Range", "[", 
               RowBox[{"count", "-", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"constraints", "=", " ", 
             RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pos", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"numbers", ",", " ", 
             RowBox[{
              RowBox[{"#", " ", ">", " ", "0"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"neg", "  ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"numbers", ",", " ", 
             RowBox[{
              RowBox[{"#", " ", "<", " ", "0"}], " ", "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zero", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"numbers", ",", " ", 
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", " ", "0"}], "&"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "pos", "]"}], " ", ">", " ", "0"}], ",", 
            " ", 
            RowBox[{"constraints", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"constraints", ",", " ", 
               RowBox[{
                RowBox[{"constants", "[", 
                 RowBox[{"[", 
                  RowBox[{"count", " ", "-", " ", 
                   RowBox[{"Length", "[", "pos", "]"}], "+", "1"}], "]"}], 
                 "]"}], " ", ">", " ", "0"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "neg", "]"}], " ", ">", " ", "0"}], ",", 
            " ", 
            RowBox[{"constraints", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"constraints", ",", " ", 
               RowBox[{
                RowBox[{"constants", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "neg", "]"}], "]"}], "]"}], " ", "<",
                 " ", "0"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "zero", "]"}], " ", ">", " ", "0"}], ",", 
            " ", 
            RowBox[{"constraints", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"constraints", ",", " ", 
               RowBox[{
                RowBox[{"constants", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Length", "[", "neg", "]"}], "+", "1"}], "]"}], 
                 "]"}], " ", "==", " ", "0"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"constraints", " ", "=", " ", 
           RowBox[{"And", " ", "@@", " ", "constraints"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rules", " ", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"numbers", "[", 
                RowBox[{"[", "#", "]"}], "]"}], " ", "\[Rule]", " ", 
               RowBox[{"constants", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", " ", 
            RowBox[{"Range", "[", "count", "]"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"expr", " ", "/.", " ", "rules"}], ",", " ", 
         RowBox[{"Reverse", "[", 
          RowBox[{"rules", ",", " ", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "constraints"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"genericize", "[", 
    RowBox[{
     RowBox[{"cone", "[", 
      RowBox[{"h", ",", "2"}], "]"}], " ", "+", " ", 
     RowBox[{"fred", "[", 
      RowBox[{
      "1.2", ",", " ", "3.14159", ",", " ", "1.2", ",", " ", "seven", ",", 
       " ", 
       RowBox[{"-", "2"}], ",", " ", 
       RowBox[{"-", "3"}], ",", " ", "0"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"2785b03d-5985-4032-b823-71703b18af08"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "enumerate", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enumerate", "[", "iterable_", "]"}], " ", ":=", " ", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#1", ",", " ", "#2"}], "}"}], "&"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "iterable", "]"}], "]"}], ",", " ", 
      "iterable"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"enumerate", "[", 
    RowBox[{"func_", ",", "iterable_"}], "]"}], " ", ":=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"func", "[", 
       RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "iterable", "]"}], "]"}], ",", " ", 
       "iterable"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", " ", "@", " ", 
   RowBox[{"enumerate", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "value"}], "}"}], ",", " ", 
      RowBox[{"value", " ", "+", " ", "i"}]}], "]"}], "@@", "#"}], "&"}], " ",
   "/@", " ", 
  RowBox[{"enumerate", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}], 
   "]"}]}]}], "Input",ExpressionUUID->"8ec68a9c-2f7a-4b02-a56f-dc20decd0fec"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "pairUp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pairUp", "[", 
   RowBox[{"a_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pairUp", "[", 
   RowBox[{"a_", ",", " ", "b_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", " ", "c"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pairUp", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", " ", "3"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"do", ",", " ", "re", ",", " ", "mi"}], "}"}]}], 
  "]"}]}], "Input",ExpressionUUID->"f5d937b1-633c-462f-b80a-4b944b3250af"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "qReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qReduce", "[", 
   RowBox[{"expr_", ",", " ", "vars_", ",", " ", 
    RowBox[{"dom_", " ", ":", " ", "Reals"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Quiet", "[", 
   RowBox[{
    RowBox[{"Reduce", "[", 
     RowBox[{"expr", ",", " ", "vars", ",", " ", "dom"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Reduce", "::", "ratnz"}], "}"}]}], 
   "]"}]}]}], "Input",ExpressionUUID->"ae93f216-c13a-4fa8-8c55-51d96176c90a"],

Cell["ToString is entirely unreasonable about newlines. So we fix.", \
"Text",ExpressionUUID->"01eaa123-f89c-4e73-a01b-9b6b353bb418"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "toString", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toString", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", " ", "reapedStrings", ",", " ", "token", ",", " ", 
      "rules", ",", " ", "reverseRules", ",", " ", "clean"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"result", ",", " ", "reapedStrings"}], "}"}], " ", "=", 
      RowBox[{"Reap", "[", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringQ", "[", "#", "]"}], ",", 
             RowBox[{"Sow", "[", "#", "]"}]}], "]"}], ")"}], "&"}], ",", 
         "expr", ",", "Infinity"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"token", " ", "=", 
      RowBox[{"FromCharacterCode", "[", "1", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "something", " ", "not", " ", "in", " ", "any", " ", "actual", " ", 
       "string"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "reapedStrings", "]"}], " ", ">", " ", "0"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rules", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", " ", "\[Rule]", " ", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<\\n\>\"", " ", "\[Rule]", " ", "token"}], "}"}]}],
              "]"}]}], " ", "&"}], "/@", " ", 
          RowBox[{"reapedStrings", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"clean", " ", "=", " ", 
         RowBox[{"expr", " ", "/.", " ", "rules"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"ToString", "[", "clean", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"result", ",", " ", 
           RowBox[{"{", 
            RowBox[{"token", " ", "\[Rule]", " ", "\"\<\\n\>\""}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "result"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "expr", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toString", "[", 
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<fre\nd ``\>\"", ",", " ", "\"\<barney\>\""}], "]"}], "]"}], 
  " ", "//", " ", "FullForm"}], "\[IndentingNewLine]", 
 RowBox[{"toString", "[", "3", 
  "]"}]}], "Input",ExpressionUUID->"fa4ede11-3c6d-455f-abf3-95b6141118d6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "formatString", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatString", "[", 
   RowBox[{"str_", ",", " ", "values__"}], "]"}], " ", ":=", " ", 
  RowBox[{"toString", " ", "@", " ", 
   RowBox[{"StringForm", "[", 
    RowBox[{"str", " ", ",", " ", 
     RowBox[{"Sequence", " ", "@@", " ", 
      RowBox[{"{", "values", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"formatString", "[", 
  RowBox[{"\"\<`` ==\n ``\>\"", ",", " ", "a", ",", " ", "b"}], 
  "]"}]}], "Input",ExpressionUUID->"f78fed21-bedf-4a41-bae1-4273afcf7913"]
}, Closed]],

Cell[CellGroupData[{

Cell["Database", \
"Section",ExpressionUUID->"357464a5-45ea-48a2-a12a-751cf054f7cf"],

Cell[CellGroupData[{

Cell["Open the Database", \
"Subsection",ExpressionUUID->"4547b9a4-8df7-490e-800b-4a7aa3844b6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"<<", "DatabaseLink`DatabaseExamples`"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DatabaseExamplesBuild", "[", "]"}]}], "\[IndentingNewLine]", 
   "*)"}], 
  RowBox[{"(*", 
   RowBox[{"JavaClassPath", "[", "]"}], 
   "*)"}]}]], "Input",ExpressionUUID->"302e56cc-aa82-4b28-b4ea-a0424818b568"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "databaseDirectory", " ", "=", " ", 
   "\"\<C:\\\\Users\\\\bob\\\\Dropbox\\\\Grad School\\\\Lutz \
Lab\\\\Data\\\\Pairwise\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"databasePath", " ", "=", " ", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"databaseDirectory", ",", " ", "\"\<Pairwise.accdb\>\""}], "}"}], 
   "]"}]}]}], "Input",ExpressionUUID->"6088f7bc-e275-418e-b0e6-c9a046de71a4"],

Cell["\<\
https://www.easysoft.com/blog/wolfram-mathematica.html
https://www.easysoft.com/products/data_access/jdbc-access-gateway/getting-\
started.html
https://docs.microsoft.com/en-us/office/troubleshoot/access/cannot-use-odbc-\
or-oledb\
\>", "Text",ExpressionUUID->"6c234aaf-66a1-4576-b74e-f6173b6434cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<DatabaseLink`\>\"", "]"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "AddToClassPath", "[", 
     "\"\<C:\\\\Program Files\\\\Easysoft Limited\\\\Easysoft JDBC-Access \
Gateway\\\\Libs\\\\esmdb.jar\>\"", "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"JavaClassPath", "[", "]"}], 
   "*)"}]}]}], "Input",ExpressionUUID->"ffd9e70f-ba90-4dae-8b57-91c56d14f7eb"],

Cell[BoxData[{
 RowBox[{"CloseSQLConnection", "[", "database", "]"}], "\[IndentingNewLine]", 
 RowBox[{"database", " ", "=", " ", 
  RowBox[{"OpenSQLConnection", "[", 
   RowBox[{
    RowBox[{"JDBC", "[", 
     RowBox[{"\"\<easysoft.sql.esMdbDriver\>\"", ",", 
      RowBox[{
      "\"\<jdbc:easysoft:mdb?DBQ=\>\"", " ", "<>", " ", "databasePath"}]}], 
     "]"}], ",", " ", 
    RowBox[{"\"\<ReadOnly\>\"", " ", "\[Rule]", " ", "True"}]}], 
   "]"}]}]}], "Input",ExpressionUUID->"f1b950b2-748a-42df-8adc-a3aa845f9834"],

Cell[CellGroupData[{

Cell["A Couple of Examples", \
"Subsubsection",ExpressionUUID->"cdf52dda-9f66-4a1c-9040-a32d40c7ef9f"],

Cell[BoxData[
 RowBox[{"SQLExecute", "[", 
  RowBox[{"database", ",", "\"\<select * from BadWells\>\"", ",", " ", 
   RowBox[{"\"\<ShowColumnHeadings\>\"", " ", "\[Rule]", " ", "True"}]}], 
  "]"}]], "Input",ExpressionUUID->"d9a54f38-f1fa-45dd-907b-9ff96efcb80c"],

Cell[BoxData[
 RowBox[{"SQLExecute", "[", 
  RowBox[{"database", ",", "\"\<Select * from BadWells Where [Row] = 8\>\""}],
   "]"}]], "Input",ExpressionUUID->"01a02530-3ff7-4adb-a2eb-a777427eecee"],

Cell[BoxData[
 RowBox[{"SQLExecute", "[", 
  RowBox[{
  "database", ",", 
   "\"\<Select * from BadWells Where [Experiment] = 'E20030501'\>\""}], 
  "]"}]], "Input",ExpressionUUID->"d4c33b5e-ed55-495c-904f-868aa8a3d361"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Experiments", \
"Section",ExpressionUUID->"774ea773-ed5e-41bb-9f5c-c46a9ad6e120"],

Cell[CellGroupData[{

Cell["Get Experimental Data", \
"Subsection",ExpressionUUID->"71d1f0cd-217d-4511-8a1c-ccd45ef4b43e"],

Cell["Convert the results of a SQLExecute into a dataset.", \
"Text",ExpressionUUID->"70d06b60-c127-43a1-be57-53c471079e93"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"makeDataset", ",", " ", "unDataset"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeDataset", "[", "sqlResult_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"headings", ",", " ", "body"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"headings", " ", "=", " ", 
      RowBox[{"sqlResult", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"body", " ", "=", " ", 
      RowBox[{"sqlResult", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dataset", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"row", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Rule", " ", "@@", " ", "#"}], "&"}], " ", "/@", " ", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"headings", ",", " ", "row"}], "}"}], "]"}]}], " ", "//",
           " ", "Association"}]}], "]"}], "/@", " ", "body"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unDataset", "[", "dataset_Dataset", "]"}], "/;", " ", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Dimensions", "[", "dataset", "]"}], "]"}], "\[Equal]", "2"}]}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Values", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
   RowBox[{"Normal", "[", "dataset", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unDataset", "[", "dataset_Dataset", "]"}], "/;", " ", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Dimensions", "[", "dataset", "]"}], "]"}], "\[Equal]", "1"}]}], 
  " ", ":=", " ", 
  RowBox[{"Normal", "[", "dataset", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unDataset", "[", "other_", "]"}], " ", ":=", " ", 
  "other"}]}], "Input",ExpressionUUID->"36e3099d-fd11-4d05-ad1d-a5ea0d2c475f"],

Cell["We define query clauses for use in the sequel below.", \
"Text",ExpressionUUID->"663e5c3e-a0d8-4975-8c0a-b9b4a9629780"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataColumns", " ", "=", " ", "\"\<*\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataTable", " ", "=", " ", "\"\<Analysis\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dataOrder", " ", "=", " ", 
   "\"\<Experiments.Experiment, FluorescenceByIndex.Temperature, \
Experiments.Index\>\""}], 
  ";"}]}], "Input",ExpressionUUID->"a73343b2-47a9-45c3-848c-ef4b07ab4539"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fitting Single Stranded Wells", \
"Subsection",ExpressionUUID->"d0169ea4-b63e-47e8-b99d-8c6121248e9d"],

Cell["\<\
We start by digging out the wells that have only one strand in them. We then \
fit a linear model to that data, on the assumption that for a solution with \
only one strand, Evagreen fluorescence will be linear in concentration, aka \
linear in moles of nucleotides.\
\>", "Text",ExpressionUUID->"df1d9f05-3f94-4a38-865b-8ac6dcd37cb3"],

Cell[CellGroupData[{

Cell["Fitting", \
"Subsubsection",ExpressionUUID->"b7e3a6df-640a-4e7b-a11f-be20f362e0ba"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "getColumnsExperimentTemp", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getColumnsExperimentTemp", "[", 
   RowBox[{"experiment_", ",", " ", "temp_", ",", " ", "columns_List"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"toString", "[", "#", "]"}], "&"}], "/@", " ", "columns"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"StringRiffle", "[", 
       RowBox[{"s", ",", " ", "\"\<, \>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"getColumnsExperimentTemp", "[", 
      RowBox[{"experiment", ",", " ", "temp", ",", " ", "s"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getColumnsExperimentTemp", "[", 
   RowBox[{"experiment_", ",", " ", "temp_", ",", " ", "columns_String"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"raw", ",", " ", "query", ",", " ", "dataset"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"raw", " ", "=", " ", 
      RowBox[{
      "\"\<SELECT \>\"", " ", "<>", " ", "columns", " ", "<>", " ", 
       "\"\< FROM \>\"", " ", "<>", " ", "dataTable", " ", "<>", 
       "\"\< WHERE ([Experiment]='`1`' AND [Temperature]=`2`) ORDER BY \>\"", 
       " ", "<>", " ", "dataOrder"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"query", " ", "=", " ", 
      RowBox[{"formatString", "[", 
       RowBox[{"raw", " ", ",", " ", "experiment", ",", " ", "temp"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataset", " ", "=", " ", 
      RowBox[{"makeDataset", "[", 
       RowBox[{"SQLExecute", "[", 
        RowBox[{"database", ",", " ", "query", ",", " ", 
         RowBox[{
         "\"\<ShowColumnHeadings\>\"", " ", "\[Rule]", " ", "True"}]}], "]"}],
        "]"}]}], ";", "\[IndentingNewLine]", "dataset"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"getColumnsExperimentTemp", "[", 
    RowBox[{"\"\<E20012701\>\"", ",", " ", "22", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<nmolSsNtA\>\"", ",", " ", "\"\<nmolSsNtB\>\"", ",", " ", 
       "\"\<nmolDsNt\>\"", ",", " ", "\"\<Value\>\"", ",", " ", 
       "\"\<StrandAConcentration\>\"", ",", " ", 
       "\"\<StrandBConcentration\>\""}], "}"}]}], "]"}], 
   "*)"}]}]}], "Input",ExpressionUUID->"ebaf77af-f3c5-4bc9-b140-7513ae5e161f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "fitSsExperimentTemp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitSsExperimentTemp", "[", 
   RowBox[{"experiment_", ",", " ", "temp_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "columns", ",", " ", "dataset", ",", " ", "ssDataset", ",", " ", "data", 
      ",", " ", "dataToFit", ",", " ", "anyDs", ",", " ", "vars", ",", " ", 
      "lm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Fetch", " ", "all", " ", "the", " ", "data", " ", "for", " ", "the", 
      " ", "experiment", " ", "at", " ", "this", " ", "temp"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "columns", " ", "=", " ", 
      "\"\<nmolSsNtA, nmolSsNtB, Value, StrandAConcentration, \
StrandBConcentration\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataset", " ", "=", " ", 
      RowBox[{"getColumnsExperimentTemp", "[", 
       RowBox[{"experiment", ",", " ", "temp", ",", " ", "columns"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "subset", " ", "in", " ", "which", " ", "we", 
       " ", "*", "know", "*", " ", "we", " ", "only", " ", "put", " ", "one", 
       " ", "strand"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ssDataset", " ", "=", " ", 
      RowBox[{"dataset", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<StrandAConcentration\>\"", "]"}], 
           "\[Equal]", " ", "0"}], "  ", "||", " ", 
          RowBox[{
           RowBox[{"#", "[", "\"\<StrandBConcentration\>\"", "]"}], 
           "\[Equal]", " ", "0"}]}], " ", "&"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Fit", " ", "a", " ", "linear", " ", "model", " ", "to", " ", "that", 
       " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"nmolSsNtA", ",", " ", "nmolSsNtB"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dataToFit", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2", ",", " ", "3"}], "}"}], "]"}], "]"}], 
        " ", "&"}], " ", "/@", " ", 
       RowBox[{"unDataset", "[", "ssDataset", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lm", " ", "=", " ", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"dataToFit", ",", " ", "vars", ",", " ", "vars"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<lmSs\>\"", " ", "\[Rule]", " ", "lm"}], ",", " ", 
        RowBox[{"\"\<experiment\>\"", " ", "\[Rule]", " ", "experiment"}], 
        ",", " ", 
        RowBox[{"\"\<temp\>\"", " ", "\[Rule]", " ", "temp"}]}], "}"}], " ", "//",
       " ", "Association"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitSs1", " ", "=", " ", 
  RowBox[{"fitSsExperimentTemp", "[", 
   RowBox[{"\"\<E20012701\>\"", ",", " ", "22"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitSs2", " ", "=", " ", 
  RowBox[{"fitSsExperimentTemp", "[", 
   RowBox[{"\"\<E20020401\>\"", ",", " ", "22"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitSs3", " ", "=", " ", 
  RowBox[{"fitSsExperimentTemp", "[", 
   RowBox[{"\"\<E20030501\>\"", ",", " ", "22"}], 
   "]"}]}]}], "Input",ExpressionUUID->"78847baf-90cb-4d65-9ff3-7336485f901e"],

Cell["\<\
We can do a similar thing for data we *know* ought to be double stranded\
\>", "Text",ExpressionUUID->"6143d9a0-9d0b-4e30-8e23-479702223295"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "fitDsExperimentTemp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitDsExperimentTemp", "[", "fitSs_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "experiment", ",", " ", "temp", ",", " ", "columns", ",", " ", "dataset",
       ",", " ", "ssDataset", ",", " ", "data", ",", " ", "dataToFit", ",", 
      " ", "anyDs", ",", " ", "vars", ",", " ", "form", ",", " ", "lm", ",", 
      " ", "xySs", ",", " ", "xDs", ",", " ", "ssExplained", ",", " ", 
      "measured", ",", " ", "addValues"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"experiment", " ", "=", " ", 
      RowBox[{"fitSs", "[", "\"\<experiment\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"fitSs", "[", "\"\<temp\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Fetch", " ", "all", " ", "the", " ", "data", " ", "for", " ", "the", 
       " ", "experiment", " ", "at", " ", "this", " ", "temp"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
     "columns", " ", "=", " ", 
      "\"\<nmolSsNtA, nmolSsNtB, nmolDsNt, Value, StrandAConcentration, \
StrandBConcentration\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataset", " ", "=", " ", 
      RowBox[{"getColumnsExperimentTemp", "[", 
       RowBox[{"experiment", ",", " ", "temp", ",", " ", "columns"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"unDataset", "[", "dataset", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xySs", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"measured", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ssExplained", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fitSs", "[", "\"\<lmSs\>\"", "]"}], " ", "@@", " ", "#"}], 
        " ", "&"}], "/@", " ", "xySs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xDs", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", "nmolDsNt", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "xDs", "]"}], " ", "\[Equal]", " ", 
        RowBox[{"Max", "[", "xDs", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"form", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dataToFit", " ", "=", 
         RowBox[{"Transpose", " ", "@", 
          RowBox[{"{", 
           RowBox[{"xDs", ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"Length", "[", "xDs", "]"}]}], "]"}]}], "}"}]}]}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"form", " ", "=", " ", "vars"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dataToFit", " ", "=", 
         RowBox[{"Transpose", " ", "@", 
          RowBox[{"{", 
           RowBox[{"xDs", ",", " ", 
            RowBox[{"measured", " ", "-", " ", "ssExplained"}]}], 
           "}"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lm", " ", "=", " ", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"dataToFit", ",", " ", "form", ",", " ", "vars"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<lmDs\>\"", " ", "\[Rule]", " ", "lm"}], ",", " ", 
        RowBox[{"\"\<lmSs\>\"", " ", "\[Rule]", " ", 
         RowBox[{"fitSs", "[", "\"\<lmSs\>\"", "]"}]}], ",", " ", 
        RowBox[{"\"\<experiment\>\"", " ", "\[Rule]", " ", "experiment"}], 
        ",", " ", 
        RowBox[{"\"\<temp\>\"", " ", "\[Rule]", " ", "temp"}]}], "}"}], " ", "//",
       " ", "Association"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitDs1", " ", "=", " ", 
  RowBox[{
  "fitDsExperimentTemp", "[", "fitSs1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitDs2", " ", "=", " ", 
  RowBox[{
  "fitDsExperimentTemp", "[", "fitSs2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitDs3", " ", "=", " ", 
  RowBox[{
  "fitDsExperimentTemp", "[", "fitSs3", 
   "]"}]}]}], "Input",ExpressionUUID->"728fc376-b279-4142-a3e5-90c7eef87810"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", \
"Subsubsection",ExpressionUUID->"e15ee605-b98d-422e-a55e-e16dd3073c9f"],

Cell["We plot that data to get a sense of how well the fit works.", \
"Text",ExpressionUUID->"8ccddb42-c9f1-4c7b-abe0-b277f6bb0882"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "plotFittedSs", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotFittedSs", "[", "fit_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lm", ",", " ", "lmDs", ",", " ", "title", ",", " ", "data", ",", " ", 
       "dataDs", ",", " ", "ssA", ",", " ", "ssB", ",", " ", "fnA", ",", " ", 
       "fnB", ",", " ", "fnDs", ",", " ", "plot", ",", " ", "plots"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", " ", "=", " ", 
       RowBox[{"fit", "[", "\"\<lmSs\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lmDs", " ", "=", 
       RowBox[{"fit", "[", "\"\<lmDs\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"title", " ", "=", " ", 
       RowBox[{"formatString", "[", 
        RowBox[{"\"\<``@``C\>\"", ",", " ", 
         RowBox[{"fit", "[", "\"\<experiment\>\"", "]"}], ",", " ", 
         RowBox[{"fit", "[", "\"\<temp\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"lm", "[", "\"\<Data\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dataDs", " ", "=", " ", 
       RowBox[{"lmDs", "[", "\"\<Data\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ssA", " ", "=", " ", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"data", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
           "&"}]}], "]"}], " ", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ssB", " ", "=", " ", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"data", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
           "&"}]}], "]"}], " ", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fnA", "[", "x_", "]"}], " ", ":=", " ", 
       RowBox[{"lm", "[", 
        RowBox[{"x", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fnB", "[", "x_", "]"}], " ", ":=", " ", 
       RowBox[{"lm", "[", 
        RowBox[{"0", ",", " ", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fnDs", "[", "x_", "]"}], " ", ":=", " ", 
       RowBox[{"lmDs", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plot", "[", 
        RowBox[{"d_", ",", " ", "f_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"d", ",", " ", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", " ", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<nmol nt\>\"", ",", " ", "\"\<RFU\>\""}], "}"}]}], 
             ",", " ", 
             RowBox[{"PlotLabel", "\[Rule]", " ", "t"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", 
               RowBox[{"Min", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plot", "[", 
          RowBox[{"ssA", ",", " ", "fnA", ",", " ", 
           RowBox[{"formatString", "[", 
            RowBox[{
            "\"\<``: RFU vs Ss (Strand A Only)\>\"", ",", " ", "title"}], 
            "]"}]}], "]"}], ",", " ", "\"\< \>\"", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"plot", "[", 
          RowBox[{"ssB", ",", " ", "fnB", ",", " ", 
           RowBox[{"formatString", "[", 
            RowBox[{
            "\"\<``: RFU vs Ss (Strand B Only)\>\"", ",", " ", "title"}], 
            "]"}]}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"dataDs", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], " ", "<", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"dataDs", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", " ", "=", " ", 
         RowBox[{"plots", " ", "~", "Join", "~", " ", 
          RowBox[{"{", 
           RowBox[{"\"\< \>\"", ",", " ", 
            RowBox[{"plot", "[", 
             RowBox[{"dataDs", ",", " ", "fnDs", ",", " ", 
              RowBox[{"formatString", "[", 
               RowBox[{
               "\"\<``: Non-Ss RFU vs Complementary Ds\>\"", ",", " ", 
                "title"}], "]"}]}], "]"}]}], "}"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Row", " ", "@", " ", "plots"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotFittedSs", "[", "fitDs1", "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotFittedSs", "[", "fitDs2", "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"plotFittedSs", "[", "fitDs3", 
  "]"}]}], "Input",ExpressionUUID->"01dcc6eb-379f-4f7e-a951-34c1a77d113e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explaining", \
"Subsubsection",ExpressionUUID->"64e8f4de-62f3-4cfe-aef4-65ba40a9f35c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ssExplain", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ssExplain", "[", "fit_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "addValues", ",", " ", "lm", ",", " ", "title", ",", " ", "columns", ",",
       " ", "dataset", ",", " ", "data", ",", " ", "xyz", ",", " ", "xy", ",",
       " ", "fittedValues", ",", " ", "measuredValues", ",", " ", 
      "unexplained"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lm", " ", "=", " ", 
      RowBox[{"fit", "[", "\"\<lm\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"title", " ", "=", " ", 
      RowBox[{"formatString", "[", 
       RowBox[{"\"\<``@``C\>\"", ",", " ", 
        RowBox[{"fit", "[", "\"\<experiment\>\"", "]"}], ",", " ", 
        RowBox[{"fit", "[", "\"\<temp\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"columns", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<nmolSsNtA\>\"", ",", " ", "\"\<nmolSsNtB\>\"", ",", 
        "\"\<Value\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataset", " ", "=", " ", 
      RowBox[{"getColumnsExperimentTemp", "[", 
       RowBox[{
        RowBox[{"fit", "[", "\"\<experiment\>\"", "]"}], ",", " ", 
        RowBox[{"fit", "[", "\"\<temp\>\"", "]"}], ",", " ", "columns"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xyz", " ", "=", " ", 
      RowBox[{"unDataset", " ", "@", " ", 
       RowBox[{"dataset", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xy", " ", "=", " ", 
      RowBox[{"xyz", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittedValues", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"lm", " ", "@@", " ", "#"}], " ", "&"}], "/@", " ", "xy"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"measuredValues", " ", "=", " ", 
      RowBox[{"xyz", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"addValues", "[", "values_", "]"}], " ", ":=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", " ", "~", "Join", "~", 
          RowBox[{"{", "#2", "}"}]}], "&"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"xy", ",", " ", "values"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"addValues", "[", "measuredValues", " ", "]"}], ",", " ", 
         RowBox[{"addValues", "[", 
          RowBox[{"measuredValues", " ", "-", " ", "fittedValues"}], "]"}]}], 
        "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", "title"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ssExplain", "[", "fitSs1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ssExplain", "[", "fitSs2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ssExplain", "[", "fitSs3", 
  "]"}]}], "Input",ExpressionUUID->"a16ab2a2-8824-4196-b9bf-550aeb26682a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wells with both strands", \
"Subsubsection",ExpressionUUID->"468671c9-1473-4a7c-9274-e8b3d7e0ff37"],

Cell["\<\
For wells with both strands, we explore the hypothesis that the \
single-stranded fluorescence on its own can explain the observed levels.

TODO: we need to subtract background! TODO: do a LinearModelFit on *all* the \
data?\
\>", "Text",ExpressionUUID->"ed5ed0fd-9147-45bf-9c65-d3a7d34e0603"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "average3D", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"average3D", "[", "dataIn_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", " ", "assoc", ",", " ", "key", ",", " ", "k", ",", " ", 
      "v"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"unDataset", "[", "dataIn", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"key", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Key", "[", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", " ", 
           RowBox[{"$MachinePrecision", "-", "3"}]}], "]"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", " ", "rfu"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", " ", "=", 
            RowBox[{"key", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"v", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"assoc", ",", " ", "k"}], "]"}], ",", " ", 
              RowBox[{"assoc", "[", "k", "]"}], ",", " ", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"assoc", "[", "k", "]"}], " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"v", ",", " ", "rfu"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], " ", "@@", " ", "#"}], "&"}], "/@", 
      " ", "data"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "k", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"k", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
          RowBox[{"Mean", "[", 
           RowBox[{"assoc", "[", "k", "]"}], "]"}]}], "}"}]}], "]"}], "/@", 
      " ", 
      RowBox[{"Keys", "[", "assoc", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",ExpressionUUID->"1a1ab7d2-3dc3-4834-a442-e0950f0556e9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "fit", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fit", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fitStrandASingle", "[", "a", "]"}], "-", 
      RowBox[{"fitStrandASingle", "[", "0", "]"}]}], ")"}], " ", "+", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fitStrandBSingle", "[", "b", "]"}], " ", "-", " ", 
      RowBox[{"fitStrandBSingle", "[", "0", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bothStrandsData", " ", "=", " ", 
    RowBox[{"expAtTempData", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<StrandAConcentration\>\"", "]"}], ">=", 
          "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"#", "[", "\"\<StrandBConcentration\>\"", "]"}], ">=", 
          "0"}]}], " ", "&"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<StrandAMols\>\"", ",", " ", "\"\<StrandBMols\>\"", ",", 
        "\"\<Value\>\""}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"average3D", "[", "bothStrandsData", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "rfu"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "b", ",", " ", "rfu", ",", " ", 
          RowBox[{"fit", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], " ", "@@", " ", 
      "#"}], "&"}], "/@", " ", 
    RowBox[{"unDataset", "[", "bothStrandsData", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "rfu", ",", " ", "fitted"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
         "a", ",", " ", "b", ",", " ", "rfu", ",", " ", "fitted", ",", " ", 
          RowBox[{"fitted", " ", "-", " ", "rfu"}]}], "}"}]}], "]"}], "@@", 
      "#"}], "&"}], "/@", " ", "data"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a", ",", " ", "b", ",", " ", "rfu", ",", " ", "fitted", ",", " ", 
          "delta"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "b", ",", " ", "rfu"}], "}"}]}], "]"}], " ", "@@",
       " ", "#"}], " ", "&"}], " ", "/@", " ", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out1", " ", "=", " ", 
   RowBox[{"average3D", "[", "out", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a", ",", " ", "b", ",", " ", "rfu", ",", " ", "fitted", ",", " ", 
          "delta"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "b", ",", " ", "fitted"}], "}"}]}], "]"}], 
      " ", "@@", " ", "#"}], " ", "&"}], " ", "/@", " ", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot3D", "[", 
     RowBox[{
      RowBox[{"{", "out1", "}"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", " ", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<A\>\"", ",", " ", "\"\<B\>\"", ",", " ", "\"\<RFU\>\""}],
         "}"}]}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
      RowBox[{"Mesh", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ListPointPlot3D", "[", 
     RowBox[{"out", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", " ", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<A\>\"", ",", " ", "\"\<B\>\"", ",", " ", "\"\<RFU\>\""}],
         "}"}]}], ",", " ", 
      RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", " ", 
         RowBox[{"PointSize", "[", "0.0075", "]"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], 
  "]"}]}], "Input",ExpressionUUID->"848c3eb5-2ae0-4ba1-b236-abf1f102481f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old", "Section",ExpressionUUID->"fd6dc9f3-17cd-4631-93ae-94bda3be1d60"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "dataColumns", " ", "=", " ", 
    "\"\<FluorescenceByIndex.Temperature, FluorescenceByIndex.Value, \
FluorescenceByIndex.Name, \n\t[StrandAMols] * [StrandALength] * 1e9 AS \
nmolNtA, \n\t[StrandBMols] * [StrandBLength] * 1e9 AS nmolNtB,\n\t\
IIf(StrandAMols<StrandBMols, StrandAMols, StrandBMols) * [Overlap] * 1e9 as \
nmolNtOverlap,\n\t[nmolNtOverlap] as nmolDsNt,\n\t[nmolNtA] - [nmolNtOverlap] \
as nmolSsNtA,\n\t[nmolNtB] - [nmolNtOverlap] as nmolSsNtB,\n\tExperiments.*\n\
\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{
   "dataTable", " ", "=", " ", 
    "\"\<Experiments LEFT JOIN FluorescenceByIndex ON (Experiments.Experiment \
= FluorescenceByIndex.Experiment) AND (Experiments.Index = \
FluorescenceByIndex.Index)\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{
   "dataOrder", " ", "=", " ", 
    "\"\<Experiments.Experiment, FluorescenceByIndex.Temperature, \
Experiments.Index\>\""}], ";"}], 
  "*)"}]], "Input",ExpressionUUID->"d690b350-772b-4e1f-bed6-a70bcc7d7845"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"SQLExecute", "[", 
   RowBox[{"database", ",", " ", 
    RowBox[{
    "\"\<SELECT \>\"", " ", "<>", " ", "dataColumns", " ", "<>", " ", 
     "\"\< FROM \>\"", "<>", " ", "dataTable", "<>", " ", 
     "\"\< WHERE ([Temperature] Is Not Null AND [StrandAConcentration]=0 AND \
[StrandBConcentration]=0) ORDER BY \>\"", " ", "<>", " ", "dataOrder"}], ",", 
    " ", 
    RowBox[{"\"\<ShowColumnHeadings\>\"", " ", "\[Rule]", " ", "True"}]}], 
   "]"}], "*)"}]], \
"Input",ExpressionUUID->"23291366-0f1e-47f2-8508-39b729d7682c"],

Cell[CellGroupData[{

Cell["EvaGreen vs Temperature", \
"Subsection",ExpressionUUID->"2374d7e8-4705-4218-986b-0ac0f79fe3c6"],

Cell["\<\
Returns wells in all experiments in which there are no strands at all.\
\>", "Text",ExpressionUUID->"b7f6d645-d0a2-4f14-9868-2e8a6904ee18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noStrandsControl", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"raw", ",", " ", "query"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"raw", " ", "=", " ", 
      RowBox[{
      "\"\<SELECT \>\"", " ", "<>", " ", "dataColumns", " ", "<>", " ", 
       "\"\< FROM \>\"", "<>", " ", "dataTable", "<>", " ", 
       "\"\< WHERE ([Temperature] Is Not Null AND [StrandAConcentration]=0 \
AND [StrandBConcentration]=0) ORDER BY \>\"", " ", "<>", " ", "dataOrder"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"query", " ", "=", " ", "raw"}], ";", "\[IndentingNewLine]", 
     RowBox[{"makeDataset", "[", 
      RowBox[{"SQLExecute", "[", 
       RowBox[{"database", ",", " ", "query", ",", " ", 
        RowBox[{"\"\<ShowColumnHeadings\>\"", " ", "\[Rule]", " ", "True"}]}],
        "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"control", " ", "=", " ", 
  RowBox[{
  "noStrandsControl", "[", 
   "]"}]}]}], "Input",ExpressionUUID->"7bfc77eb-d86e-4911-8d3a-15d0aed66a42"],

Cell["Returns the names of all experiments that have data.", \
"Text",ExpressionUUID->"eeecbe92-5c05-4f43-8f41-de995cc0a79a"],

Cell[BoxData[
 RowBox[{"experimentNames", " ", "=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"Normal", "[", 
    RowBox[{"control", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", "\"\<Experiment\>\""}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",ExpressionUUID->"03dae6f0-7fee-40da-aee7-83f47240ba6c"],

Cell["For fun, plot the RFU of all no-strand controls", \
"Text",ExpressionUUID->"f45b68d8-cdd5-402c-ae19-ab9e03b37761"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"control", "[", 
   RowBox[{
    RowBox[{"GroupBy", "[", "\"\<Experiment\>\"", "]"}], ",", "All", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Temperature\>\"", ",", "\"\<Value\>\""}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<T\>\"", ",", " ", "\"\<RFU\>\""}], "}"}]}]}], 
  "]"}]}], "Input",ExpressionUUID->"d493f72d-bef0-4eb9-be31-b799047bb6d1"],

Cell["Same thing, but for a particular date.", \
"Text",ExpressionUUID->"0985de26-cc63-4598-bb41-1b1e28104fe8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "  ", "=", " ", 
   RowBox[{"control", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "\"\<Date\>\"", "]"}], " ", "==", " ", 
       RowBox[{"SQLDateTime", "[", 
        RowBox[{"{", 
         RowBox[{
         "2020", ",", " ", "02", ",", " ", "04", ",", " ", "0", ",", " ", "0",
           ",", " ", "0."}], "}"}], "]"}]}], "&"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"data", "[", 
    RowBox[{
     RowBox[{"GroupBy", "[", "\"\<Experiment\>\"", "]"}], ",", " ", "All", 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Temperature\>\"", ",", " ", "\"\<Value\>\""}], "}"}]}], 
    "]"}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<T\>\"", ",", " ", "\"\<RFU\>\""}], "}"}]}]}], 
  "]"}]}], "Input",ExpressionUUID->"1f148f56-1fd9-4b55-8d9d-79a72d1c0c03"]
}, Closed]],

Cell[CellGroupData[{

Cell["One Experiment, One Temp", \
"Subsection",ExpressionUUID->"8803bca1-d677-4f9a-a93a-e880bc96b40f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"experimentAtTemp", "[", 
   RowBox[{"experiment_", ",", " ", "temp_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"raw", ",", " ", "query"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"raw", " ", "=", " ", 
      RowBox[{
      "\"\<SELECT \>\"", " ", "<>", " ", "dataColumns", " ", "<>", " ", 
       "\"\< FROM \>\"", " ", "<>", " ", "dataTable", " ", "<>", 
       "\"\< WHERE ([Experiment]='`1`' AND [Temperature]=`2`) ORDER BY \>\"", 
       " ", "<>", " ", "dataOrder"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"query", " ", "=", " ", 
      RowBox[{"formatString", "[", 
       RowBox[{"raw", " ", ",", " ", "experiment", ",", " ", "temp"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"makeDataset", "[", 
      RowBox[{"SQLExecute", "[", 
       RowBox[{"database", ",", " ", "query", ",", " ", 
        RowBox[{"\"\<ShowColumnHeadings\>\"", " ", "\[Rule]", " ", "True"}]}],
        "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expAtTempData", " ", "=", " ", 
  RowBox[{"experimentAtTemp", "[", 
   RowBox[{"\"\<E20012701\>\"", ",", " ", "20"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"expAtTempData", " ", "=", " ", 
    RowBox[{"experimentAtTemp", "[", 
     RowBox[{"\"\<E20020401\>\"", ",", " ", "20"}], "]"}]}], 
   "*)"}]}]}], "Input",ExpressionUUID->"6fb6c0f8-9e39-44bf-b225-afbd9aa5419f"],

Cell[CellGroupData[{

Cell["Single Stranded Fit", \
"Subsubsection",ExpressionUUID->"6f424fda-c084-4b30-b552-6be730df7245"],

Cell["\<\
We assume single-stranded fluorescence is a linear function of the number of \
molecules of an underlying strand. We extract from the data the wells that \
have only one strand, and fit a line to each.\
\>", "Text",ExpressionUUID->"c0a69a82-7a3f-4301-8693-6ccb6402f737"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"strandASingleData", " ", "=", " ", 
   RowBox[{"expAtTempData", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<StrandBConcentration\>\"", "]"}], "\[Equal]", 
        " ", "0"}], " ", "&"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<StrandAMols\>\"", ",", " ", "\"\<Value\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strandBSingleData", " ", "=", " ", 
   RowBox[{"expAtTempData", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<StrandAConcentration\>\"", "]"}], "\[Equal]", 
        " ", "0"}], " ", "&"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<StrandBMols\>\"", ",", " ", "\"\<Value\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fitStrandASingle", " ", "=", " ", 
    RowBox[{"LinearModelFit", "[", " ", 
     RowBox[{
      RowBox[{"unDataset", "[", "strandASingleData", "]"}], ",", " ", 
      "molsSsA", ",", " ", "molsSsA"}], "]"}]}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"fitStrandBSingle", " ", "=", " ", 
    RowBox[{"LinearModelFit", "[", " ", 
     RowBox[{
      RowBox[{"unDataset", "[", "strandBSingleData", "]"}], ",", " ", 
      "molsSsB", ",", " ", "molsSsB"}], "]"}]}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitStrandASingleSlope", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitStrandASingle", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitStrandBSingleSlope", " ", "=", " ", 
   RowBox[{
    RowBox[{"fitStrandBSingle", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fitStrandASingle", "[", "\"\<AdjustedRSquared\>\"", "]"}], ",", 
   " ", 
   RowBox[{"fitStrandBSingle", "[", "\"\<AdjustedRSquared\>\"", "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"Row", " ", "@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"strandASingleData", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ","}], "*)"}], " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<molsA\>\"", ",", "\"\<RFU\>\""}], "}"}]}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", " ", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"fitStrandASingle", "[", "count", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"count", ",", " ", "0", ",", " ", "11*^-11"}], "}"}]}], 
       "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"strandBSingleData", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ","}], "*)"}], " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<molsB\>\"", ",", "\"\<RFU\>\""}], "}"}]}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", " ", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"fitStrandBSingle", "[", "count", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"count", ",", " ", "0", ",", " ", "11*^-11"}], "}"}]}], 
       "]"}]}], "]"}]}], 
   "}"}]}]}], "Input",ExpressionUUID->"d22a981f-ccb9-4e2d-a951-a1726d55c122"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double Stranded Fit", \
"Subsubsection",ExpressionUUID->"bd8a0273-4f19-484f-b4d1-1e2821165c9b"],

Cell["\<\
First way fits three-way fit of molarities of our ss and ds portions, first \
with pure linear fit, then (for giggles) allowing a square term (no \
justification, but the fit is much better).\
\>", "Text",ExpressionUUID->"4aa3eaaf-9d65-4f50-a954-dc46622151fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dsData", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", "\"\<nmolDsNt\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<nmolSsNtA\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<nmolSsNtB\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], " ", "&"}], " ", "/@",
      " ", "data"}], " ", "//", " ", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dsFit0", " ", "=", " ", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "dsData", "]"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"nmolDsNt", ",", " ", "nmolSsNtA", ",", " ", "nmolSsNtB"}], 
     "}"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"nmolDsNt", ",", " ", "nmolSsNtA", ",", " ", "nmolSsNtB"}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"dsData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"dsFit0", "[", "\"\<FitResiduals\>\"", "]"}]}], "}"}], "]"}], 
  " ", "//", " ", 
  "ListPlot"}]}], \
"Input",ExpressionUUID->"0c17de91-4819-405c-81d7-4414a1b1bc46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dsData", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", "\"\<nmolDsNt\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<nmolSsNtA\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<nmolSsNtB\>\"", "]"}], ",", " ", 
        RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "}"}], " ", "&"}], " ", "/@",
      " ", "data"}], " ", "//", " ", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dsFit0", " ", "=", " ", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "dsData", "]"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"nmolDsNt", ",", " ", 
      RowBox[{"nmolDsNt", "^", "2"}], ",", " ", "nmolSsNtA", ",", " ", 
      "nmolSsNtB"}], "}"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"nmolDsNt", ",", " ", "nmolSsNtA", ",", " ", "nmolSsNtB"}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"dsData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"dsFit0", "[", "\"\<FitResiduals\>\"", "]"}]}], "}"}], "]"}], 
  " ", "//", " ", 
  "ListPlot"}]}], \
"Input",ExpressionUUID->"a245b31c-13fb-48e3-afdb-063a1bf40319"],

Cell["Second way subtracts off the ss fit first", \
"Text",ExpressionUUID->"c717160d-567c-4eaf-b48e-646c8407c898"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dsData", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", "\"\<nmolDsNt\>\"", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"#", "[", "\"\<Value\>\"", "]"}], " ", "-", " ", 
         RowBox[{"fitStrandASingleSlope", " ", "*", " ", 
          RowBox[{"#", "[", "\"\<nmolSsNtA\>\"", "]"}]}], " ", "-", " ", 
         RowBox[{"fitStrandBSingleSlope", " ", "*", " ", 
          RowBox[{"#", "[", "\"\<nmolSsNtB\>\"", "]"}]}]}]}], "}"}], " ", 
      "&"}], " ", "/@", " ", "data"}], " ", "//", " ", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dsFit", " ", "=", " ", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "dsData", "]"}], ",", " ", 
    RowBox[{"{", " ", "nmolDsNt", "}"}], ",", " ", 
    RowBox[{"{", " ", "nmolDsNt", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"dsData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"dsFit", "[", "\"\<FitResiduals\>\"", "]"}]}], "}"}], "]"}], " ",
   "//", " ", "ListPlot"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"dsData", ",", " ", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<nmolDsNt\>\"", ",", "\"\<RFU\>\""}], "}"}]}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", " ", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"dsFit", "[", "conc", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"conc", ",", " ", "0", ",", " ", "10"}], "}"}]}], "]"}]}], "]"}]
  }], "Input",ExpressionUUID->"fcd178b3-36b2-418a-a554-4b6d55a2df23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dsData", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", "\"\<nmolDsNt\>\"", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"#", "[", "\"\<Value\>\"", "]"}], " ", "-", " ", 
         RowBox[{"fitStrandASingleSlope", " ", "*", " ", 
          RowBox[{"#", "[", "\"\<nmolSsNtA\>\"", "]"}]}], " ", "-", " ", 
         RowBox[{"fitStrandBSingleSlope", " ", "*", " ", 
          RowBox[{"#", "[", "\"\<nmolSsNtB\>\"", "]"}]}]}]}], "}"}], " ", 
      "&"}], " ", "/@", " ", "data"}], " ", "//", " ", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dsFit", " ", "=", " ", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "dsData", "]"}], ",", " ", 
    RowBox[{"{", " ", 
     RowBox[{"nmolDsNt", ",", " ", 
      RowBox[{"nmolDsNt", "^", "2"}]}], "}"}], ",", " ", 
    RowBox[{"{", " ", "nmolDsNt", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"dsData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"dsFit", "[", "\"\<FitResiduals\>\"", "]"}]}], "}"}], "]"}], " ",
   "//", " ", "ListPlot"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"dsData", ",", " ", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<nmolDsNt\>\"", ",", "\"\<RFU\>\""}], "}"}]}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", " ", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"dsFit", "[", "conc", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"conc", ",", " ", "0", ",", " ", "10"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",ExpressionUUID->"862f2bfc-7fac-4015-a66e-4145965c841a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thoughts", \
"Subsection",ExpressionUUID->"603b21c3-d591-4fdb-96d0-61e75e9d6516"],

Cell["\<\
* How do we account for the fact that our eva molecules are beging eaten up \
as they bind, thus reducing background fluoresence.\
\>", "Text",ExpressionUUID->"4d37d500-1ade-4beb-9558-f13300441229"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Misc", "Section",ExpressionUUID->"77386c64-cbe1-49a7-bdbf-c47696c08719"],

Cell["\<\
https://stackoverflow.com/questions/29855062/setting-parameter-values-in-sql-\
for-ms-access\
\>", "Text",ExpressionUUID->"aa3a8019-a87d-47f5-a6bc-033900d84f92"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1294, 1541},
WindowMargins->{{Automatic, 1219}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
CellContext->Notebook,
CellLabelAutoDelete->True,
TrackCellChangeTimes->False,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Graphics"], MenuSortingValue -> 10000, Background -> None], 
   Cell[
    StyleData[All, "Printout"], Magnification -> 0.5]}, Visible -> False, 
  FrontEndVersion -> "12.0 for Microsoft Windows (64-bit) (April 8, 2019)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

